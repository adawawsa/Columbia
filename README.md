# 健康診断予約システム

健康診断の予約・管理を効率化するためのウェブアプリケーションです。社員は健康診断の予約を行い、管理者は予約状況を把握・管理できます。

## 主な機能

- **予約管理**: 社員は健康診断の日時を選択して予約できます
- **グループ予約**: 部署単位での健康診断予約が可能
- **結果管理**: 健康診断結果のアップロードと閲覧
- **管理者ダッシュボード**: 予約状況の一覧確認と承認/却下
- **ユーザープロフィール**: 個人情報の管理と更新

## セキュリティ機能

- **パスワード保護**: すべてのパスワードはbcryptアルゴリズムを使用してハッシュ化して保存
- **安全な認証**: パスワード検証にwerkzeug.security.check_password_hash()を使用
- **環境変数による設定**: 秘密鍵などの重要な設定情報を環境変数から読み込み
- **ファイルアップロード制限**:
  - 最大ファイルサイズの制限（5MB）
  - 安全なファイル名生成とパス操作の防止
  - ファイル形式の検証（許可された拡張子のみ: PDF, JPG, JPEG, PNG）

## セットアップ方法

### 必要条件

- Python 3.8以上
- Flask
- SQLite3

### インストール手順

1. リポジトリをクローン
   ```
   git clone [repository-url]
   cd kenshin
   ```

2. 依存パッケージのインストール
   ```
   pip install -r requirements.txt
   ```

3. 環境変数の設定
   .envファイルを作成して以下の内容を設定：
   ```
   SECRET_KEY=あなたの秘密鍵をここに設定（本番環境では強固なランダム値を使用）
   ```

4. アプリケーションの実行
   ```
   python app.py
   ```

5. ブラウザで以下のURLにアクセス
   ```
   http://localhost:5000
   ```

## ログイン情報

テスト用のアカウント情報は以下の通りです：

- **一般ユーザー**:
  - ID: test
  - パスワード: test

- **管理者**:
  - ID: admin
  - パスワード: admin

- **産業医**:
  - ID: doctor
  - パスワード: doctor

## システム構成

- **Flask**: Webアプリケーションフレームワーク
- **SQLite**: データベース
- **Flask-Login**: ユーザー認証管理
- **Flask-CORS**: クロスオリジン対応

## データベース構造

- **users**: ユーザー情報（ID、名前、部署、権限など）
- **reservations**: 予約情報（日時、ステータスなど）
- **reservation_groups**: グループ予約情報
- **exam_results**: 健康診断結果データ

## 注意事項

- 本番環境では適切なセキュリティ設定に変更してください
- `app.secret_key`は本番環境で必ず変更してください

## 更新履歴

- 2025-03-23: GitHubアクセストークンの動作確認テスト
